---
layout: post
title: Creating An Oracle Linked Server For SQL Server 2008 x64
date: '2011-07-06 16:47:47'
---

This was a lot harder than I would have expected and took nearly 2 days of bashing my head against a wall to get it working, anyway here are the steps I ended up taking.
<ol class="PostListOl">
	<li class="PostListItemOl">Download the Oracle 11g R2 Client installers (Both the 32bit and 64bit versions).</li>
	<li class="PostListItemOl">Run the 32bit installer</li>
<ol class="PostListOl">
	<li class="PostListItemOl">For my installation path I specified c:\oracle</li>
	<li class="PostListItemOl">For the software location I specified c:\oracle\product\11.2.0\client_32</li>
	<li class="PostListItemOl">For the available product components I ticked the following</li>
<ul class="PostList">
	<li class="PostListItem">SQL Plus</li>
	<li class="PostListItem">Oracle Call Interface</li>
	<li class="PostListItem">Oracle Net</li>
	<li class="PostListItem">Oracle Connection Manager</li>
	<li class="PostListItem">Oracle Services For Microsoft Transaction Server</li>
	<li class="PostListItem">Oracle Administration Assistant For Windows</li>
	<li class="PostListItem">Oracle Provider for OLE DB</li>
	<li class="PostListItem">Oracle Data Provider for .Net</li>
	<li class="PostListItem">Oracle Providers for ASP.Net</li>
</ul>
	<li class="PostListItemOl">When Net configuration runs click "Default configuration" and next through it</li>
</ol>
	<li class="PostListItemOl">Repeat the above steps for the 64bit installer with the following changes</li>
<ul class="PostList">
	<li class="PostListItem">Instead of _32 in your software location path put 64 e.g. c:\oracle\product\11.2.0\client_64</li>
	<li class="PostListItem">An error will most likely come up mid way through install saying "OracleMTSRecovaryService already exists", just click continue</li>
</ul>
	<li class="PostListItemOl">Modify the following registry keys</li>
<ul class="PostList">
	<li class="PostListItem">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\MSDTC\MTxOCI\OracleSqlLib to orasql11.dll</li>
	<li class="PostListItem">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\MSDTC\MTxOCI\OracleXaLib to oraclient11.dll</li>
	<li class="PostListItem">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\MTxOCI\OracleSqlLib to orasql11.dll</li>
	<li class="PostListItem">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\MTxOCI\OracleXaLib to oraclient11.dll</li>
</ul>
	<li class="PostListItemOl">In management studio expend the Linked Servers node, then expend the Providers node. Right click OraOledb.oracle and go in to the properties. Tick "Allow In Process" then click OK.</li>
	<li class="PostListItemOl">Create or edit the following file C:\oracle\product\11.2.0\client_64\Network\Admin\tnsnames.oraÂ with your database settings, it should look somthing like this...</li>

<pre class="brush: csharp; toolbar: false;">
# tnsnames.ora Network Configuration File: C:\oracle\product\10.2.0\db_1\NETWORK\ADMIN\tnsnames.ora
# Generated by Oracle configuration tools. 

GavsOracleDB =
   (DESCRIPTION =
      (ADDRESS_LIST =
         (ADDRESS =
            (PROTOCOL = TCP)
            (HOST = gavindraper.co.uk)
            (PORT = 1521)
         )
      )
      (CONNECT_DATA = (SERVICE_NAME = mytest.gavdraper))
   )</pre>
<li class="PostListItemOl">Reboot the server</li>
<li class="PostListItemOl">You should then be able to create a linked server to Oracle using the Add Linked Server Wizard in SQL Server</li>
</ol>